<!DOCTYPE html>
<html>
<body style="font-family: Arial; background:#f4f4f4; padding:20px">

<h2>Certificate Verification</h2>
<p id="output">Verifying certificate...</p>

<script>
const sheetId = "1bTIBgInp4B5I-CK1F0b55rJtlOhIza_I";
const sheetName = "Certificates";
const url = "https://opensheet.elk.sh/" + sheetId + "/" + sheetName;

const certId = new URLSearchParams(window.location.search)
  .get("id")
  ?.trim();

fetch(url)
.then(res => res.json())
.then(data => {
  const row = data.find(r => {
  const sheetId =
    (r["CERTIFICATE ID"] ||
     r["Certificate ID"] ||
     "").toString().trim();

  return sheetId === certId;
});
  document.getElementById("output").innerHTML = row
    ? `<b>Name:</b> ${row.NAME}<br>
       <b>Event:</b> ${row.EVENT}<br>
       <b>Date:</b> ${row.DATE}<br>
       <b>Status:</b> ${row.STATUS}`
    : "‚ùå Invalid Certificate";
});
</script>

</body>
</html>
